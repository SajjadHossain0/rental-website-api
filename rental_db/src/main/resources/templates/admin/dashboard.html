<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{admin/layout}">

<head>
    <title>Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div layout:fragment="content">

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-title">Total Properties</span>
                <span class="stat-value" th:text="${totalProperties}">0</span>
            </div>
            <div class="stat-card">
                <span class="stat-title">Active Listings</span>
                <span class="stat-value" th:text="${activeListings}">0</span>
            </div>
            <div class="stat-card">
                <span class="stat-title">Total Value</span>
                <span class="stat-value"
                    th:text="${'$' + #numbers.formatDecimal(totalValue, 0, 'COMMA', 0, 'POINT')}">$0</span>
            </div>
            <div class="stat-card">
                <span class="stat-title">Avg. Price</span>
                <span class="stat-value"
                    th:text="${'$' + #numbers.formatDecimal(averagePrice, 0, 'COMMA', 0, 'POINT')}">$0</span>
            </div>
        </div>

        <div class="grid-2" style="margin-bottom: 30px; grid-template-columns: 2fr 1fr;">
            <!-- Recent Activity -->
            <div class="card">
                <h2 style="margin-bottom: 20px; font-size: 1.25rem;">Recent Properties</h2>
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="text-align: left; border-bottom: 1px solid #e5e7eb;">
                            <th style="padding: 10px;">Title</th>
                            <th style="padding: 10px;">Price</th>
                            <th style="padding: 10px;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="prop : ${recentProperties}" style="border-bottom: 1px solid #f3f4f6;">
                            <td style="padding: 10px;" th:text="${prop.title}">Title</td>
                            <td style="padding: 10px;" th:text="${'$' + prop.price}">$0</td>
                            <td style="padding: 10px;">
                                <span th:if="${prop.available}"
                                    style="color: #10b981; font-size: 0.875rem;">Available</span>
                                <span th:unless="${prop.available}"
                                    style="color: #ef4444; font-size: 0.875rem;">Rented</span>
                            </td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(recentProperties)}">
                            <td colspan="3" style="padding: 20px; text-align: center; color: #6b7280;">No recent
                                activity.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Chart -->
            <div class="card">
                <h2 style="margin-bottom: 20px; font-size: 1.25rem;">Properties by Type</h2>
                <canvas id="typeChart"></canvas>
            </div>
        </div>

        <script th:inline="javascript">
            /*<![CDATA[*/
            const labels = /*[[${chartLabels}]]*/[];
            const data = /*[[${chartData}]]*/[];

            const ctx = document.getElementById('typeChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#4f46e5', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            /*]]>*/
        </script>

    </div>

</body>

</html>